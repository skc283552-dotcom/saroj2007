<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Accounting System</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
<style>
body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f4f4f9; }
header { background: #2c3e50; color: #fff; padding: 15px; text-align: center; font-size: 22px; }
.dashboard { display: flex; justify-content: center; gap: 20px; margin: 30px; flex-wrap: wrap; }
.icon { width: 150px; height: 150px; background: #3498db; color: white; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: bold; cursor: pointer; border-radius: 15px; transition: 0.3s; }
.icon:hover { background: #2980b9; }
.page { display: none; padding: 20px; }
table { border-collapse: collapse; width: 100%; margin-top: 20px; }
table, th, td { border: 1px solid #ddd; }
th, td { padding: 10px; text-align: center; }
button { padding: 6px 12px; margin: 5px; cursor: pointer; border: none; border-radius: 6px; }
.back-btn { background: #e74c3c; color: white; }
.save-btn { background: #27ae60; color: white; }
.edit-btn { background: #f39c12; color: white; }
.delete-btn { background: #c0392b; color: white; }
.download-btn { background: #8e44ad; color: white; }
.balance-div { margin-top: 15px; font-weight: bold; }
</style>
</head>
<body>
<header>ðŸ“Š Accounting System</header>

<!-- Dashboard -->
<div class="dashboard" id="dashboard">
Â  <div class="icon" onclick="openPage('journal')">ðŸ“˜ Journal</div>
Â  <div class="icon" onclick="openPage('ledger')">ðŸ“— Ledger</div>
Â  <div class="icon" onclick="openPage('transactions')">ðŸ“’ Transactions</div>
Â  <div class="icon" onclick="downloadPDF()">ðŸ“‘ Download PDF</div>
</div>

<!-- Journal Page -->
<div class="page" id="journal">
Â  <h2>Journal Entry</h2>
Â  <form id="journalForm">
Â  Â  <label>Particular:</label><input type="text" id="particular" required><br><br>
Â  Â  <label>Debit (Dr):</label><input type="number" id="debit" value="0"><br><br>
Â  Â  <label>Credit (Cr):</label><input type="number" id="credit" value="0"><br><br>
Â  Â  <label>Status:</label>
Â  Â  <select id="status">
Â  Â  Â  <option value="Paid">Paid</option>
Â  Â  Â  <option value="Unpaid">Unpaid</option>
Â  Â  </select><br><br>
Â  Â  <label>Payment Type:</label>
Â  Â  <select id="paymentType">
Â  Â  Â  <option>Cash</option>
Â  Â  Â  <option>Bank</option>
Â  Â  Â  <option>eSewa</option>
Â  Â  Â  <option>Fonepay</option>
Â  Â  </select><br><br>
Â  Â  <button type="submit" class="save-btn">Save Entry</button>
Â  </form>
Â  <button class="back-btn" onclick="goBack()">â¬… Back</button>
</div>

<!-- Ledger Page -->
<div class="page" id="ledger">
Â  <h2>Ledger</h2>
Â  <label>Search by Name:</label> <input type="text" id="searchName">
Â  <label>Search by Date:</label> <input type="date" id="searchDate">
Â  <button onclick="filterLedger()">Search</button>
Â  <table id="ledgerTable">
Â  Â  <thead>
Â  Â  Â  <tr><th>Date</th><th>Particular</th><th>Debit</th><th>Credit</th><th>Status</th><th>Payment</th><th>Balance</th></tr>
Â  Â  </thead>
Â  Â  <tbody></tbody>
Â  </table>
Â  <h3>Total Balance: <span id="ledgerTotal">0</span></h3>
Â  <div id="ledgerPaymentBalances" class="balance-div"></div>
Â  <button class="back-btn" onclick="goBack()">â¬… Back</button>
</div>

<!-- Transactions Page -->
<div class="page" id="transactions">
Â  <h2>All Transactions</h2>
Â  <table id="transactionTable">
Â  Â  <thead>
Â  Â  Â  <tr><th>Date</th><th>Particular</th><th>Debit</th><th>Credit</th><th>Status</th><th>Payment</th><th>Actions</th></tr>
Â  Â  </thead>
Â  Â  <tbody></tbody>
Â  </table>
Â  <h3>Total Income: <span id="totalIncome">0</span> | Total Expense: <span id="totalExpense">0</span></h3>
Â  <div id="paymentBalances" class="balance-div"></div>
Â  <button class="back-btn" onclick="goBack()">â¬… Back</button>
</div>

<script>
let entries = JSON.parse(localStorage.getItem("entries")) || [];

function openPage(pageId) {
Â  document.querySelectorAll(".page").forEach(p => p.style.display = "none");
Â  document.getElementById("dashboard").style.display = "none";
Â  document.getElementById(pageId).style.display = "block";
Â  if (pageId === "ledger") loadLedger();
Â  if (pageId === "transactions") loadTransactions();
}

function goBack() {
Â  document.querySelectorAll(".page").forEach(p => p.style.display = "none");
Â  document.getElementById("dashboard").style.display = "flex";
}

document.getElementById("journalForm").addEventListener("submit", function(e) {
Â  e.preventDefault();
Â  let date = new Date().toISOString().split("T")[0];
Â  let particular = document.getElementById("particular").value;
Â  let debit = parseFloat(document.getElementById("debit").value) || 0;
Â  let credit = parseFloat(document.getElementById("credit").value) || 0;
Â  let status = document.getElementById("status").value;
Â  let paymentType = document.getElementById("paymentType").value;

Â  entries.push({ date, particular, debit, credit, status, paymentType });
Â  localStorage.setItem("entries", JSON.stringify(entries));
Â  alert("Entry Saved!");
Â  this.reset();
});

function calculateBalances() {
Â  let balances = { Cash:0, Bank:0, eSewa:0, Fonepay:0 };
Â  entries.forEach(e => {
Â  Â  let net = (e.credit || 0) - (e.debit || 0);
Â  Â  balances[e.paymentType] = (balances[e.paymentType] || 0) + net;
Â  });
Â  return balances;
}

function loadTransactions() {
Â  let tbody = document.querySelector("#transactionTable tbody");
Â  tbody.innerHTML = "";
Â  let totalIncome = 0, totalExpense = 0;
Â  entries.forEach((e, i) => {
Â  Â  totalIncome += e.credit;
Â  Â  totalExpense += e.debit;
Â  Â  let row = `<tr>
Â  Â  Â  <td>${e.date}</td><td>${e.particular}</td><td>${e.debit}</td>
Â  Â  Â  <td>${e.credit}</td><td>${e.status}</td><td>${e.paymentType}</td>
Â  Â  Â  <td>
Â  Â  Â  Â  <button class="edit-btn" onclick="editEntry(${i})">Edit</button>
Â  Â  Â  Â  <button class="delete-btn" onclick="deleteEntry(${i})">Delete</button>
Â  Â  Â  </td>
Â  Â  </tr>`;
Â  Â  tbody.innerHTML += row;
Â  });
Â  document.getElementById("totalIncome").innerText = totalIncome;
Â  document.getElementById("totalExpense").innerText = totalExpense;

Â  let balances = calculateBalances();
Â  let balanceDiv = document.getElementById("paymentBalances");
Â  balanceDiv.innerHTML = `Cash: ${balances.Cash} | Bank: ${balances.Bank} | eSewa: ${balances.eSewa} | Fonepay: ${balances.Fonepay}`;
}

function loadLedger() {
Â  let tbody = document.querySelector("#ledgerTable tbody");
Â  tbody.innerHTML = "";
Â  let total = 0;
Â  entries.forEach(e => {
Â  Â  total += e.credit - e.debit;
Â  Â  tbody.innerHTML += `<tr>
Â  Â  Â  <td>${e.date}</td><td>${e.particular}</td>
Â  Â  Â  <td>${e.debit}</td><td>${e.credit}</td>
Â  Â  Â  <td>${e.status}</td><td>${e.paymentType}</td>
Â  Â  Â  <td>${total}</td>
Â  Â  </tr>`;
Â  });
Â  document.getElementById("ledgerTotal").innerText = total;

Â  let balances = calculateBalances();
Â  let ledgerBalanceDiv = document.getElementById("ledgerPaymentBalances");
Â  ledgerBalanceDiv.innerHTML = `Cash: ${balances.Cash} | Bank: ${balances.Bank} | eSewa: ${balances.eSewa} | Fonepay: ${balances.Fonepay}`;
}

function filterLedger() {
Â  let name = document.getElementById("searchName").value.toLowerCase();
Â  let date = document.getElementById("searchDate").value;
Â  let tbody = document.querySelector("#ledgerTable tbody");
Â  tbody.innerHTML = "";
Â  let total = 0;
Â  entries.filter(e => (!name || e.particular.toLowerCase().includes(name)) &&
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (!date || e.date === date))
Â  Â  Â  Â  Â .forEach(e => {
Â  Â  total += e.credit - e.debit;
Â  Â  tbody.innerHTML += `<tr>
Â  Â  Â  <td>${e.date}</td><td>${e.particular}</td>
Â  Â  Â  <td>${e.debit}</td><td>${e.credit}</td>
Â  Â  Â  <td>${e.status}</td><td>${e.paymentType}</td>
Â  Â  Â  <td>${total}</td>
Â  Â  </tr>`;
Â  });
Â  document.getElementById("ledgerTotal").innerText = total;

Â  let balances = calculateBalances();
Â  document.getElementById("ledgerPaymentBalances").innerHTML =
Â  Â  `Cash: ${balances.Cash} | Bank: ${balances.Bank} | eSewa: ${balances.eSewa} | Fonepay: ${balances.Fonepay}`;
}

function deleteEntry(index) {
Â  if (confirm("Delete this entry?")) {
Â  Â  entries.splice(index, 1);
Â  Â  localStorage.setItem("entries", JSON.stringify(entries));
Â  Â  loadTransactions();
Â  Â  loadLedger();
Â  }
}

function editEntry(index) {
Â  let e = entries[index];
Â  document.getElementById("particular").value = e.particular;
Â  document.getElementById("debit").value = e.debit;
Â  document.getElementById("credit").value = e.credit;
Â  document.getElementById("status").value = e.status;
Â  document.getElementById("paymentType").value = e.paymentType;
Â  deleteEntry(index);
Â  openPage("journal");
}

function downloadPDF() {
Â  const { jsPDF } = window.jspdf;
Â  let doc = new jsPDF();
Â  doc.text("Accounting Transactions Report", 14, 15);
Â  doc.autoTable({
Â  Â  startY: 20,
Â  Â  head: [["Date", "Particular", "Debit", "Credit", "Status", "Payment", "Balance"]],
Â  Â  body: entries.map((e, i) => [
Â  Â  Â  e.date, e.particular, e.debit, e.credit, e.status, e.paymentType,
Â  Â  Â  entries.slice(0, i+1).reduce((t, x) => t + (x.credit - x.debit), 0)
Â  Â  ])
Â  });

Â  let y = doc.lastAutoTable.finalY + 10;
Â  let balances = calculateBalances();
Â  doc.text(`Balances: Cash ${balances.Cash} | Bank ${balances.Bank} | eSewa ${balances.eSewa} | Fonepay ${balances.Fonepay}`, 14, y);

Â  doc.save("transactions.pdf");
}
</script>
</body>
</html>

